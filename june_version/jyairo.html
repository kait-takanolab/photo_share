<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>home page</title>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.6.1/css/bulma.css">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
        <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/exif-js/2.2.1/exif.min.js"></script>

    </head>
    <body>
        <section class="hero is-primary is-bold">
                <div class="hero-body">
                    <div class="container">
                    <h1 class="title">
                        photo sharering
                    </h1>
                    </div>
                </div>
                <div class="hero-foot">
                    <nav class="tabs is-boxed is-fullwidth">
                        <div class="container">
                            <ul>
                            <li><a href="home.html">home</a></li>
                            <li class="is-active"><a href="photo_upload.html">Upload</a></li>
                            <li><a href="view_photo.html">Veiw your photo</a></li>
                            <li><a>hoge</a></li>
                            <li><a>hogehoge</a></li>
                            </ul>
                        </div>
                    </nav>
                </div>
        </section>
        
        <div class="field">
            <div class="file is-primary">
                <label class="file-label">
                <input class="file-input" type="file" name="photo" id="img" onclick="get_starttime()">
                    <script type="text/javascript">
                        var alpha = 0;
                        var beta = 0;
                        var gamma = 0;          
                        window.addEventListener("deviceorientation", handleOrientation, true);
                        function handleOrientation(event) {
                            alpha = event.alpha;
                            beta  = event.beta;
                            gamma = event.gamma;
                        };
                        function get_starttime() {
                            var nowtime=new Date(); 
                            var first_timestanp=nowtime.getTime();
                            console.log(first_timestanp);
                            document.getElementById("output2").innerHTML=first_timestanp;   
                        }
                        //値が変化した時に実行されるイベント
                        var input_file = document.getElementById("img");
                        input_file.onchange = function (e){
                            // ファイルが選択されたか
                            if(input_file.value){
                                console.log("ファイルが選択された:" + input_file.value);
                                var nowtime2=new Date(); 
                                var finish_timestanp=nowtime2.getTime();
                                console.log(finish_timestanp);
                                //document.getElementById("output1").innerHTML= input_file.value;
                                var reader = new FileReader();
                                reader.onload = function (e) {
                                    $("#preview").attr('src', e.target.result);
                                }
                                reader.readAsDataURL(e.target.files[0]);
                                document.getElementById("output3").innerHTML=finish_timestanp;
                                document.getElementById("output4").innerHTML = alpha+"<br>"+beta+"<br>"+gamma;          
                            }else{
                                console.log("ファイルが未選択");
                            }
                        };    
        
                    </script>
                <span class="file-cta">
                    <span class="file-icon">
                    <i class="fa fa-upload"></i>
                    </span>
                    <span class="file-label">
                    Select photo
                    </span>
                </span>
                </label>
            </div>
            <img id = "preview">
            <div class="has-text-black" id="output2"></div>
            <div class="has-text-black" id="output3"></div>
            <div class="has-text-black" id="output4"></div>
        </div>


    </body>
</html>